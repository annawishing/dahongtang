<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="大泓堂"/>
    <meta name="keywords" content="欢迎前来 大泓贸易 大泓堂 选购养生"/>
    <title>大泓堂</title>
    <style type="text/css">

        body{
            margin: 0;
            padding: 0;
            background: url('img/bg2.jpg') no-repeat fixed center top transparent;
            text-align: center;
        }
        table{
            position: relative;
            padding: 0;
            margin: 250px auto 120px;
            left: 20px;
        }

        #logo{

        }
        #qrcode{
            width: 240px;
            height: 240px;
        }
        #weixin{
            height: 40px;
            font-size: 20px;
            text-shadow: 0px 1px 0px #fff;
        }
        #taobao{
            height: 30px;
            font-size: 16px;
            text-shadow: 0px 1px 0px #fff;
        }
        a{
            font-size: 18px;
            margin: 10px;
        }
        .fwresult{
            font-size: 14px;
            color: #222;
            text-shadow: 0px 1px 0px #fff;
        }
    </style>
</head>
<body>
<table>
    <tr>
        <td>
            <a href="http://www.dahongmaoyi.com">
            <img id='logo' src="img/logo.png" alt=""/>
            </a>
        </td>
    </tr>
    <tr>
        <td><img id='qrcode' src="img/xuncaisp.png" alt="" width="240" height="240"/></td>
    </tr>
    <tr>
        <td id='weixin'>扫描二维码进入<a href="http://xuncaisp.tmall.com">大泓堂官方天猫店</a></td>
    </tr>
    <tr>
        <td>或者进入<a href="http://dahongtang.taobao.com">大泓堂集市店</a></td>
    </tr>
    <tr>
        <td>
            <input type="input" class="fwcode" placeholder="请输入防伪码"/>
            <button class="query">查询</button>
        </td>
    </tr>
    <tr>
        <td>
            <div class="fwresult"></div>
        </td>
    </tr>
</table>
<script type="text/javascript" src="javascripts/jquery-1.8.2.min.js"></script>
<script type="text/javascript">
            $(function() {
                var $fwcode = $(".fwcode");
                var $fwresult = $(".fwresult");
                var RegNumber = /^[0-9]*[1-9][0-9]*$/;
                var flag = false;
                $(".query").click(function() {
                    var code =  $.trim($fwcode.val());
                    $fwresult.html("");
                    if (code.length === 0) {
                        $fwresult.html("防伪码不能为空");
                        $fwcode.focus();
                        return false;
                    }
                    else if (code.length < 10) {
                        $fwresult.html("防伪码长度不能少于10位");
                        $fwcode.focus();
                        return false;
                    }
                    else if (code.length > 24) {
                        $fwresult.html("防伪码长度不能大于24位");
                        $fwcode.focus();
                        return false;
                    }
                    else if (!RegNumber.test(code)) {
                        $fwresult.html("您输入的防伪码不是数字");
                        $fwcode.focus();
                        return false;
                    }
                    $fwresult.html("正在查询......");
                    $(this).attr("disabled", true);  //禁止按钮
                    $.ajaxSetup({ scriptCharset: "gbk" , contentType: "application/json; charset=gbk"});
                    $.getJSON(
                            "http://www.3653315.com/fwipjson.asp?callback=?","",
                            function(data2) {
                                // alert(data2.fwip);     //fwip   返回ip地址如：http://14.150.36.134:6080
                                $.getJSON(
                                        data2.fwip + "/fwqueryjson.asp?callback=?",
                                        { FwCode: code },
                                        function(data) {
                                            //   alert(data.CodeState);    //CodeState 为查询状况：1 正确; 2 过期 ; 3 重复 ;   4 作废; 5 错误 ;6 过期
                                            //   alert(data.QueryResult) ;   //QueryResult 查询结果
                                            //此处可以根据返回的结果  data.CodeState 修改显示内容
                                            $fwresult.html(data.QueryResult);     //显示数据
                                            setTimeout(btnEnabled, 2000);          //2000ms后开启按钮
                                        });
                            }
                    );
                });
                function btnEnabled() {
                    $(".query").attr("disabled", false);
                }
            });

</script>
</body>
</html>
